{
  "id": 109,
  "slug": "jdbc-resultset-vs-jpa-criteria",
  "title": "JDBC ResultSet Mapping vs JPA Criteria API",
  "category": "enterprise",
  "difficulty": "advanced",
  "jdkVersion": "11",
  "oldLabel": "Java EE",
  "modernLabel": "Jakarta EE 8+",
  "oldApproach": "JDBC ResultSet",
  "modernApproach": "JPA Criteria API",
  "oldCode": "String sql = \"SELECT * FROM users\"\n    + \" WHERE status = ? AND age > ?\";\ntry (Connection con = ds.getConnection();\n     PreparedStatement ps =\n             con.prepareStatement(sql)) {\n    ps.setString(1, status);\n    ps.setInt(2, minAge);\n    ResultSet rs = ps.executeQuery();\n    List<User> users = new ArrayList<>();\n    while (rs.next()) {\n        User u = new User();\n        u.setId(rs.getLong(\"id\"));\n        u.setName(rs.getString(\"name\"));\n        u.setAge(rs.getInt(\"age\"));\n        users.add(u);\n    }\n}",
  "modernCode": "@PersistenceContext\nEntityManager em;\n\npublic List<User> findActiveAboveAge(\n        String status, int minAge) {\n    CriteriaBuilder cb = em.getCriteriaBuilder();\n    CriteriaQuery<User> cq =\n        cb.createQuery(User.class);\n    Root<User> root = cq.from(User.class);\n    cq.select(root).where(\n        cb.equal(root.get(\"status\"), status),\n        cb.greaterThan(root.get(\"age\"), minAge));\n    return em.createQuery(cq).getResultList();\n}",
  "summary": "Replace manual JDBC ResultSet mapping with JPA's type-safe Criteria API for dynamic queries.",
  "explanation": "Raw JDBC requires building SQL strings, setting parameters by index, and mapping each ResultSet column manually ‚Äî a process that is error-prone and breaks silently when columns change. The JPA Criteria API builds queries programmatically using a type-safe builder pattern. Column names are validated against the entity model, result mapping is automatic, and complex dynamic queries compose cleanly without string concatenation.",
  "whyModernWins": [
    {
      "icon": "üîí",
      "title": "Type-safe queries",
      "desc": "The Criteria builder catches field name and type mismatches at compile time."
    },
    {
      "icon": "üó∫Ô∏è",
      "title": "Automatic mapping",
      "desc": "JPA maps result rows to entity objects ‚Äî no manual column-by-column extraction."
    },
    {
      "icon": "üß©",
      "title": "Composable predicates",
      "desc": "Dynamic where-clauses build cleanly with and(), or(), and reusable Predicate objects."
    }
  ],
  "support": {
    "state": "available",
    "description": "Widely available since Jakarta EE 8 / Java 11"
  },
  "prev": "enterprise/singleton-ejb-vs-cdi-application-scoped",
  "next": "enterprise/spring-xml-config-vs-annotations",
  "related": [
    "enterprise/jdbc-vs-jpa",
    "enterprise/jpa-vs-jakarta-data",
    "enterprise/manual-transaction-vs-declarative"
  ],
  "docs": [
    {
      "title": "Jakarta Persistence Specification",
      "href": "https://jakarta.ee/specifications/persistence/"
    },
    {
      "title": "Jakarta Persistence 3.1 ‚Äî Criteria API",
      "href": "https://jakarta.ee/specifications/persistence/3.1/apidocs/"
    }
  ]
}
